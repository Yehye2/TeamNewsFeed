<!DOCTYPE html>
<html>

<head>
    <title>Book Search</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #fff;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            border-radius: 4px;
        }

        .title {
            font-size: 24px;
            margin-bottom: 20px;
        }

        .search-form {
            display: flex;
        }

        .search-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        .search-button {
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .search-results {
            margin-top: 20px;
        }

        .book-container {
            padding: 10px;
            background-color: #f9f9f9;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin-bottom: 10px;
        }

        .book-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .book-author {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .book-description {
            font-size: 14px;
            color: #333;
        }

        .no-results {
            font-size: 16px;
            color: #666;
            text-align: center;
        }

        .bestsellers {
            margin-top: 20px;
            font-size: 16px;
        }

        .bestsellers-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            list-style-type: none;
        }

        .bestsellers-item {
            margin: 10px;
        }

        .posts-list {
            margin-top: 20px;
            font-size: 16px;
        }

        .post-container {
            padding: 10px;
            background-color: #f9f9f9;
            border: 1px solid #ccc;
            border-radius: 4px;
            margin-bottom: 10px;
        }

        .post-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .post-content {
            font-size: 14px;
            color: #333;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1 class="title">Book Search</h1>
        <div class="search-form">
            <input type="text" id="searchInput" class="search-input" placeholder="Enter a book title">
            <button onclick="searchBooks()" class="search-button">Search</button>
        </div>

        <div id="searchResults" class="search-results"></div>

        <div class="bestsellers">
            <h2>Bestsellers</h2>
            <ul id="bestsellersList" class="bestsellers-list"></ul>
        </div>

        <div class="posts-list">
            <h2>Posts</h2>
            <ul id="postsList"></ul>
        </div>
    </div>

    <script>
        function searchBooks() {
            var query = document.getElementById('searchInput').value;
            var url = '/search?q=' + encodeURIComponent(query);

            fetch(url)
                .then(function (response) {
                    return response.json();
                })
                .then(function (books) {
                    var resultsContainer = document.getElementById('searchResults');
                    resultsContainer.innerHTML = '';

                    if (books && books.length > 0) {
                        for (var i = 0; i < books.length; i++) {
                            var book = books[i];

                            var bookContainer = document.createElement('div');
                            bookContainer.className = 'book-container';

                            var bookTitle = document.createElement('h3');
                            bookTitle.className = 'book-title';
                            bookTitle.textContent = book.title;

                            var bookAuthor = document.createElement('p');
                            bookAuthor.className = 'book-author';
                            bookAuthor.textContent = 'Author: ' + book.author;

                            var bookDescription = document.createElement('p');
                            bookDescription.className = 'book-description';
                            bookDescription.textContent = 'Description: ' + book.description;

                            bookContainer.appendChild(bookTitle);
                            bookContainer.appendChild(bookAuthor);
                            bookContainer.appendChild(bookDescription);

                            resultsContainer.appendChild(bookContainer);
                        }
                    } else {
                        var noResultsMessage = document.createElement('p');
                        noResultsMessage.className = 'no-results';
                        noResultsMessage.textContent = '찾을 수 없습니다.';
                        resultsContainer.appendChild(noResultsMessage);
                    }
                })
                .catch(function (error) {
                    console.error('Error searching books:', error);
                });
        }

        function displayBestsellers() {
            var bestsellersList = document.getElementById('bestsellersList');

            fetch('/bestsellers')
                .then(function (response) {
                    return response.json();
                })
                .then(function (bestsellers) {
                    if (bestsellers && bestsellers.length > 0) {
                        for (var i = 0; i < bestsellers.length; i++) {
                            var bestseller = bestsellers[i];

                            var bestsellerItem = document.createElement('li');
                            bestsellerItem.className = 'bestsellers-item';

                            // Create an <img> element for the book cover
                            var coverImage = document.createElement('img');
                            coverImage.src = bestseller.cover; // Assuming the API response provides the cover image URL
                            coverImage.alt = bestseller.title; // Assuming the API response provides the book title
                            bestsellerItem.appendChild(coverImage);

                            bestsellersList.appendChild(bestsellerItem);
                        }
                    } else {
                        var noBestsellersMessage = document.createElement('li');
                        noBestsellersMessage.className = 'bestsellers-item';
                        noBestsellersMessage.textContent = '찾을 수 없습니다.';

                        bestsellersList.appendChild(noBestsellersMessage);
                    }
                })
                .catch(function (error) {
                    console.error('Error fetching bestsellers:', error);
                });
        }


        function displayPosts() {
            var postsList = document.getElementById('postsList');

            fetch('/posts')
                .then(function (response) {
                    return response.json();
                })
                .then(function (result) {
                    var posts = result.posts;
                    console.log(posts);
                    if (posts && posts.length > 0) {
                        for (var i = 0; i < posts.length; i++) {
                            var post = posts[i];

                            var postContainer = document.createElement('div');
                            postContainer.className = 'post-container';

                            var postTitle = document.createElement('h3');
                            postTitle.className = 'post-title';
                            postTitle.textContent = post.title;

                            var postContent = document.createElement('p');
                            postContent.className = 'post-content';
                            postContent.textContent = post.content;

                            postContainer.appendChild(postTitle);
                            postContainer.appendChild(postContent);

                            postsList.appendChild(postContainer);
                        }
                    } else {
                        var noPostsMessage = document.createElement('li');
                        noPostsMessage.className = 'no-results';
                        noPostsMessage.textContent = '게시글이 없습니다.';

                        postsList.appendChild(noPostsMessage);
                    }
                })
                .catch(function (error) {
                    console.error('Error fetching posts:', error);
                });
        }

        displayBestsellers();
        displayPosts();
    </script>
</body>

</html>